\documentclass{wg21}

\usepackage{xcolor}
\usepackage{soul}
\usepackage{ulem}
\usepackage{fullpage}
\usepackage{parskip}
\usepackage{csquotes}
\usepackage{listings}
\usepackage{minted}
\usepackage{enumitem}

\lstdefinestyle{base}{
  language=c++,
  breaklines=false,
  basicstyle=\ttfamily\color{black},
  moredelim=**[is][\color{green!50!black}]{@}{@},
  escapeinside={(*@}{@*)}
}

\newcommand{\cc}[1]{\mintinline{c++}{#1}}
\newminted[cpp]{c++}{}


\title{Add \cc{std::is_partitioned_until} algorithm}
\docnumber{P0000}
\audience{LEWGI}
\author{Alexander Zaitsev}{zamazan4ik@tut.by, zamazan4ik@gmail.com}

\begin{document}
\maketitle

\section{Revision history}
\begin{itemize}
  \item R0 -- Initial draft
\end{itemize}


\section{Abstract}


\section{Motivation}
\cc{std::is_partitioned} was added long time ago to the standard library. Algorithm is useful but sometimes we additionally need an infromation about "where partition is over". Current \cc{std::is_partitioned} returns only \cc{bool} and we cannot change an interface of existing function. So we can add additional function {std::is_partitioned_until} which returns an iterator instead of bool.

\section{Proposed wording}
Add to \textbf{[alg.partitions] 25.7.4}:
\begin{quote}
[...]	
\begin{itemdecl}
template<class InputIterator, class Predicate>
  constexpr InputIterator is_partitioned_until(InputIterator first, InputIterator last,
                                               Predicate pred);
template<class ExecutionPolicy, class InputIterator, class Predicate>
  InputIterator is_partitioned_until(ExecutionPolicy&& exec, InputIterator first,
                                     InputIterator last, Predicate pred);
\end{itemdecl}

\begin{itemdecl}
template<input_iterator I, sentinel_for<I> S, class Proj = identity,
         indirect_unary_predicate<projected<I, Proj>> Pred>
  constexpr bool ranges::is_partitioned(I first, S last, Pred pred, Proj proj = {});	
template<input_range R, class Proj = identity, 
         indirect_unary_predicate<projected<iterator_t<R>, Proj>> Pred>
  constexpr InputIterator is_partitioned_until(R&& r, Pred pred, Proj proj = {});
\end{itemdecl}
    Let proj be identity{} for the overloads with no parameter named proj.
    
    Returns: true if and only if the elements e of [first, last) are partitioned with respect to the expression bool(invoke(pred, invoke(proj, e))).
    
    Complexity: Linear. At most last - first applications of pred and proj.
[...]
\end{quote}

\section{Implementation}
Possible implementation can be found in Boost.Algorithm: \href{https://github.com/boostorg/algorithm/blob/develop/include/boost/algorithm/is_partitioned_until.hpp}{GitHub}. Documentation can be found here: \href{https://www.boost.org/doc/libs/1_70_0/libs/algorithm/doc/html/the_boost_algorithm_library/Misc/is_partitioned_until.html}{Boost}.Available in Boost.Algorithm since Boost 1.65.

\end{document}
